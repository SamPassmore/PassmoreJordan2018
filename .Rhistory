d_merge
d$V1
uto_link$sam_taxon
f
f
files
f = files[77]
d = read.table(f)
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
head(d_merge)
d = d_merge %>% select(taxon, V2, V3)
head(d)
mirrored_phylogeny(d, con_trees[[3]])
library(phytools)
library(ape)
library(stringr)
library(dplyr)
source('figures/figure-helper.R')
# here is code to create mirrored phylogenies with tips plotted
text_cex = 0.6
# read data + trees
con_trees = list(
# Austronesian
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/gray_et_al2009/summary.trees'),
# Bantu
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/grollemund_et_al2015/summary.trees'),
# Uto Aztecan
read.nexus('~/Google Drive/UniWork/varikin/language-trees/uto-aztecan/utoaztecan-covarion-relaxed.mcct.trees')
)
con_trees = lapply(con_trees, ladderize)
files = list.files('data/co-evo/', pattern = '*.btdata', full.names = TRUE)
uto_link = read.csv('data/uto_link.csv')
pdf('figures/coevolution-plots.pdf')
for(f in files){
d = read.table(f)
if(str_detect(f, "austronesian"))
mirrored_phylogeny(d, con_trees[[1]])
if(str_detect(f, "bantu"))
mirrored_phylogeny(d, con_trees[[2]])
if(str_detect(f, "uto"))
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
d = d_merge %>% select(taxon, V2, V3)
mirrored_phylogeny(d, con_trees[[3]])
}
dev.off() # save
# save as pdf
pdf('figures/coevolution-plots.pdf')
for(f in files){
d = read.table(f)
if(str_detect(f, "austronesian"))
mirrored_phylogeny(d, con_trees[[1]])
if(str_detect(f, "bantu"))
mirrored_phylogeny(d, con_trees[[2]])
if(str_detect(f, "uto"))
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
d = d_merge %>% select(taxon, V2, V3)
mirrored_phylogeny(d, con_trees[[3]])
}
dev.off() # save
warnings()
f = files[1]
d = read.table(f)
if(str_detect(f, "austronesian"))
mirrored_phylogeny(d, con_trees[[1]])
td = geiger::treedata(con_trees[[1]], d)
warnings()
d = read.table(f)
rownames(d) = d[,1]
td = geiger::treedata(con_trees[[1]], d)
mirrored_phylogeny(td$data, td$phy)
library(phytools)
library(ape)
library(stringr)
library(dplyr)
source('figures/figure-helper.R')
# here is code to create mirrored phylogenies with tips plotted
text_cex = 0.6
# read data + trees
con_trees = list(
# Austronesian
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/gray_et_al2009/summary.trees'),
# Bantu
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/grollemund_et_al2015/summary.trees'),
# Uto Aztecan
read.nexus('~/Google Drive/UniWork/varikin/language-trees/uto-aztecan/utoaztecan-covarion-relaxed.mcct.trees')
)
con_trees = lapply(con_trees, ladderize)
files = list.files('data/co-evo/', pattern = '*.btdata', full.names = TRUE)
uto_link = read.csv('data/uto_link.csv')
# save as pdf
pdf('figures/coevolution-plots.pdf')
for(f in files){
d = read.table(f)
rownames(d) = d[,1]
if(str_detect(f, "austronesian")){
td = geiger::treedata(con_trees[[1]], d)
mirrored_phylogeny(td$data, td$phy)
}
if(str_detect(f, "bantu")){
td = geiger::treedata(con_trees[[2]], d)
mirrored_phylogeny(td$data, td$phy)
}
if(str_detect(f, "uto")){
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
d = d_merge %>% select(taxon, V2, V3)
mirrored_phylogeny(d, con_trees[[3]])
}
}
dev.off() # save
title = test
rownames(d) = d[,1]
d[,2:3] = apply(d[,2:3], 2, function(c) ifelse(c == 1, "#E41A1C", "white"))
d = d[tree$tip.label,]
par(mar = rep(0, 4))
# layout organise the plot into thirds
layout(matrix(1:3,1,3),widths=c(0.39,0.20,0.39))
# plot the first tree + labels
plot(tree,lwd=6, show.tip.label = FALSE, no.margin = TRUE)
tiplabels(node = d[tree$tip.label,2], pch = 21, bg = d[tree$tip.label,2], col = "black", cex = 1.5)
# move to the next plot
plot.new()
# size that plot appropriately
plot.window(xlim=c(-0.1,0.1),
ylim=get("last_plot.phylo",envir=.PlotPhyloEnv)$y.lim)
mtext(text = title, side = 3)
text
title
title = "test"
mtext(text = title, side = 3)
mtext(text = title, outer = TRUE)
mtext(text = title, outer = TRUE, font = 1,at = c(-1, 1))
mtext(text = title, outer = TRUE, font = 1, line = -1)
mirrored_phylogeny = function(d, tree, title = ""){
rownames(d) = d[,1]
d[,2:3] = apply(d[,2:3], 2, function(c) ifelse(c == 1, "#E41A1C", "white"))
d = d[tree$tip.label,]
par(mar = rep(0, 4))
# layout organise the plot into thirds
layout(matrix(1:3,1,3),widths=c(0.39,0.20,0.39))
# plot the first tree + labels
plot(tree,lwd=6, show.tip.label = FALSE, no.margin = TRUE)
tiplabels(node = d[tree$tip.label,2], pch = 21, bg = d[tree$tip.label,2], col = "black", cex = 1.5)
# move to the next plot
plot.new()
# size that plot appropriately
plot.window(xlim=c(-0.1,0.1),
ylim=get("last_plot.phylo",envir=.PlotPhyloEnv)$y.lim)
mtext(text = title, outer = TRUE, font = 1, line = -1)
par(cex=0.6)
# plot the taxa names
text(rep(0,length(tree$tip.label)),1:Ntip(tree),
gsub("_"," ", tree$tip.label[tree$edge[tree$edge<tree$Nnode]]),font=1)
# plot the thrid tree in new section
plot(tree,lwd=6, show.tip.label = FALSE, direction = 'leftwards', no.margin = TRUE)
tiplabels(node = d[,2], pch = 21, bg = d[,3], col = "black", cex = 1.5)
}
library(phytools)
library(ape)
library(stringr)
library(dplyr)
source('figures/figure-helper.R')
# here is code to create mirrored phylogenies with tips plotted
text_cex = 0.6
# read data + trees
con_trees = list(
# Austronesian
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/gray_et_al2009/summary.trees'),
# Bantu
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/grollemund_et_al2015/summary.trees'),
# Uto Aztecan
read.nexus('~/Google Drive/UniWork/varikin/language-trees/uto-aztecan/utoaztecan-covarion-relaxed.mcct.trees')
)
con_trees = lapply(con_trees, ladderize)
files = list.files('data/co-evo/', pattern = '*.btdata', full.names = TRUE)
uto_link = read.csv('data/uto_link.csv')
# save as pdf
pdf('figures/coevolution-plots.pdf')
for(f in files){
d = read.table(f)
rownames(d) = d[,1]
if(str_detect(f, "austronesian")){
td = geiger::treedata(con_trees[[1]], d)
mirrored_phylogeny(td$data, td$phy)
}
if(str_detect(f, "bantu")){
td = geiger::treedata(con_trees[[2]], d)
mirrored_phylogeny(td$data, td$phy)
}
if(str_detect(f, "uto")){
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
d = d_merge %>% select(taxon, V2, V3)
mirrored_phylogeny(d, con_trees[[3]])
}
}
dev.off() # save
f
f %>%
basename(.) %>%
tools::file_path_sans_ext(.)
library(phytools)
library(ape)
library(stringr)
library(dplyr)
source('figures/figure-helper.R')
# here is code to create mirrored phylogenies with tips plotted
text_cex = 0.6
# read data + trees
con_trees = list(
# Austronesian
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/gray_et_al2009/summary.trees'),
# Bantu
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/grollemund_et_al2015/summary.trees'),
# Uto Aztecan
read.nexus('~/Google Drive/UniWork/varikin/language-trees/uto-aztecan/utoaztecan-covarion-relaxed.mcct.trees')
)
con_trees = lapply(con_trees, ladderize)
files = list.files('data/co-evo/', pattern = '*.btdata', full.names = TRUE)
uto_link = read.csv('data/uto_link.csv')
# save as pdf
pdf('figures/coevolution-plots.pdf')
for(f in files){
d = read.table(f)
rownames(d) = d[,1]
title = f %>%
basename(.) %>%
tools::file_path_sans_ext(.)
if(str_detect(f, "austronesian")){
td = geiger::treedata(con_trees[[1]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "bantu")){
td = geiger::treedata(con_trees[[2]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "uto")){
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
d = d_merge %>% select(taxon, V2, V3)
mirrored_phylogeny(d, con_trees[[3]], title = title)
}
}
dev.off() # save
rownames(d) = d[,1]
d[,2:3] = apply(d[,2:3], 2, function(c) ifelse(c == 1, "#E41A1C", "white"))
d = d[tree$tip.label,]
par(mar = rep(0, 4))
# layout organise the plot into thirds
layout(matrix(1:3,1,3),widths=c(0.39,0.20,0.39))
# plot the first tree + labels
plot(tree,lwd=6, show.tip.label = TRUE, no.margin = TRUE)
# move to the next plot
plot.new()
# size that plot appropriately
plot.window(xlim=c(-0.1,0.1),
ylim=get("last_plot.phylo",envir=.PlotPhyloEnv)$y.lim)
mtext(text = title, outer = TRUE, font = 1, line = -1)
par(cex=0.6)
# plot the taxa names
text(rep(0,length(tree$tip.label)),1:Ntip(tree),
gsub("_"," ", tree$tip.label[tree$edge[tree$edge<tree$Nnode]]),font=1)
tree$Nnode
langth(tree$tip.label)
length(tree$tip.label)
# plot the taxa names
text(rep(0,length(tree$tip.label)),1:Ntip(tree),
gsub("_"," ", tree$tip.label[tree$edge[tree$edge<length(tree$tip.label)]]),font=1)
tree$tip.label[tree$edge[tree$edge<=length(tree$tip.label)]]
# plot the thrid tree in new section
plot(tree,lwd=6, show.tip.label = FALSE, direction = 'leftwards', no.margin = TRUE)
tiplabels(node = d[,2], pch = 21, bg = d[,3], col = "black", cex = 1.5)
rownames(d) = d[,1]
d[,2:3] = apply(d[,2:3], 2, function(c) ifelse(c == 1, "#E41A1C", "white"))
d = d[tree$tip.label,]
par(mar = rep(0, 4))
# layout organise the plot into thirds
layout(matrix(1:3,1,3),widths=c(0.39,0.20,0.39))
# plot the first tree + labels
plot(tree,lwd=6, show.tip.label = TRUE, no.margin = TRUE)
tiplabels(node = d[tree$tip.label,2], pch = 21, bg = d[tree$tip.label,2], col = "black", cex = 1.5)
# move to the next plot
plot.new()
# size that plot appropriately
plot.window(xlim=c(-0.1,0.1),
ylim=get("last_plot.phylo",envir=.PlotPhyloEnv)$y.lim)
mtext(text = title, outer = TRUE, font = 1, line = -1)
par(cex=0.6)
# plot the taxa names
text(rep(0,length(tree$tip.label)),1:Ntip(tree),
gsub("_"," ", tree$tip.label[tree$edge[tree$edge<=length(tree$tip.label)]]),font=1)
mirrored_phylogeny = function(d, tree, title = ""){
rownames(d) = d[,1]
d[,2:3] = apply(d[,2:3], 2, function(c) ifelse(c == 1, "#E41A1C", "white"))
d = d[tree$tip.label,]
par(mar = rep(0, 4))
# layout organise the plot into thirds
layout(matrix(1:3,1,3),widths=c(0.39,0.20,0.39))
# plot the first tree + labels
plot(tree,lwd=6, show.tip.label = FALSE, no.margin = TRUE)
tiplabels(node = d[tree$tip.label,2], pch = 21, bg = d[tree$tip.label,2], col = "black", cex = 1.5)
# move to the next plot
plot.new()
# size that plot appropriately
plot.window(xlim=c(-0.1,0.1),
ylim=get("last_plot.phylo",envir=.PlotPhyloEnv)$y.lim)
mtext(text = title, outer = TRUE, font = 1, line = -1)
par(cex=0.6)
# plot the taxa names
text(rep(0,length(tree$tip.label)),1:Ntip(tree),
gsub("_"," ", tree$tip.label[tree$edge[tree$edge<=length(tree$tip.label)]]),font=1)
# plot the thrid tree in new section
plot(tree,lwd=6, show.tip.label = FALSE, direction = 'leftwards', no.margin = TRUE)
tiplabels(node = d[,2], pch = 21, bg = d[,3], col = "black", cex = 1.5)
}
library(phytools)
library(ape)
library(stringr)
library(dplyr)
source('figures/figure-helper.R')
# here is code to create mirrored phylogenies with tips plotted
text_cex = 0.6
# read data + trees
con_trees = list(
# Austronesian
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/gray_et_al2009/summary.trees'),
# Bantu
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/grollemund_et_al2015/summary.trees'),
# Uto Aztecan
read.nexus('~/Google Drive/UniWork/varikin/language-trees/uto-aztecan/utoaztecan-covarion-relaxed.mcct.trees')
)
con_trees = lapply(con_trees, ladderize)
files = list.files('data/co-evo/', pattern = '*.btdata', full.names = TRUE)
uto_link = read.csv('data/uto_link.csv')
# save as pdf
pdf('figures/coevolution-plots.pdf')
for(f in files){
d = read.table(f)
rownames(d) = d[,1]
title = f %>%
basename(.) %>%
tools::file_path_sans_ext(.)
if(str_detect(f, "austronesian")){
td = geiger::treedata(con_trees[[1]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "bantu")){
td = geiger::treedata(con_trees[[2]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "uto")){
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
d = d_merge %>% select(taxon, V2, V3)
mirrored_phylogeny(d, con_trees[[3]], title = title)
}
}
dev.off() # save
library(phytools)
library(ape)
library(stringr)
library(dplyr)
source('figures/figure-helper.R')
# here is code to create mirrored phylogenies with tips plotted
text_cex = 0.6
# read data + trees
con_trees = list(
# Austronesian
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/gray_et_al2009/summary.trees'),
# Bantu
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/grollemund_et_al2015/summary.trees'),
# Uto Aztecan
read.nexus('~/Google Drive/UniWork/varikin/language-trees/uto-aztecan/utoaztecan-covarion-relaxed.mcct.trees')
)
con_trees = lapply(con_trees, ladderize)
files = list.files('data/co-evo/', pattern = '*.btdata', full.names = TRUE)
uto_link = read.csv('data/uto_link.csv')
# save as pdf
pdf('figures/coevolution-plots.pdf')
for(f in files){
d = read.table(f)
rownames(d) = d[,1]
title = f %>%
basename(.) %>%
tools::file_path_sans_ext(.)
if(str_detect(f, "austronesian")){
td = geiger::treedata(con_trees[[1]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "bantu")){
td = geiger::treedata(con_trees[[2]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "uto")){
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
d = d_merge %>% select(taxon, V2, V3)
mirrored_phylogeny(d, con_trees[[3]], title = title)
}
}
dev.off() # save
library(phytools)
library(ape)
library(stringr)
library(dplyr)
source('figures/figure-helper.R')
# here is code to create mirrored phylogenies with tips plotted
text_cex = 0.6
# read data + trees
con_trees = list(
# Austronesian
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/gray_et_al2009/summary.trees'),
# Bantu
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/grollemund_et_al2015/summary.trees'),
# Uto Aztecan
read.nexus('~/Google Drive/UniWork/varikin/language-trees/uto-aztecan/utoaztecan-covarion-relaxed.mcct.trees')
)
con_trees = lapply(con_trees, ladderize)
files = list.files('data/co-evo/', pattern = '*.btdata', full.names = TRUE)
uto_link = read.csv('data/uto_link.csv')
# save as pdf
pdf('figures/coevolution-plots.pdf')
for(f in files){
d = read.table(f)
rownames(d) = d[,1]
title = f %>%
basename(.) %>%
tools::file_path_sans_ext(.)
if(str_detect(f, "austronesian")){
td = geiger::treedata(con_trees[[1]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "bantu")){
td = geiger::treedata(con_trees[[2]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "uto")){
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
d = d_merge %>% select(taxon, V2, V3)
mirrored_phylogeny(d, con_trees[[3]], title = title)
}
}
dev.off() # save
library(phytools)
library(ape)
library(stringr)
library(dplyr)
source('figures/figure-helper.R')
# here is code to create mirrored phylogenies with tips plotted
text_cex = 0.6
# read data + trees
con_trees = list(
# Austronesian
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/gray_et_al2009/summary.trees'),
# Bantu
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/grollemund_et_al2015/summary.trees'),
# Uto Aztecan
read.nexus('~/Google Drive/UniWork/varikin/language-trees/uto-aztecan/utoaztecan-covarion-relaxed.mcct.trees')
)
con_trees = lapply(con_trees, ladderize)
files = list.files('data/co-evo/', pattern = '*.btdata', full.names = TRUE)
uto_link = read.csv('data/uto_link.csv')
# save as pdf
pdf('figures/coevolution-plots.pdf')
for(f in files){
d = read.table(f)
rownames(d) = d[,1]
title = f %>%
basename(.) %>%
tools::file_path_sans_ext(.)
if(str_detect(f, "austronesian")){
td = geiger::treedata(con_trees[[1]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "bantu")){
td = geiger::treedata(con_trees[[2]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
if(str_detect(f, "uto")){
d_merge = left_join(d, uto_link, by = c("V1" = "sam_taxon"))
d = d_merge %>% select(taxon, V2, V3)
mirrored_phylogeny(d, con_trees[[3]], title = title)
}
}
dev.off() # save
library(phytools)
library(ape)
library(stringr)
library(dplyr)
source('figures/figure-helper.R')
# here is code to create mirrored phylogenies with tips plotted
text_cex = 0.6
# read data + trees
con_trees = list(
# Austronesian
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/gray_et_al2009/summary.trees'),
# Bantu
read.nexus('https://raw.githubusercontent.com/D-PLACE/dplace-data/master/phylogenies/grollemund_et_al2015/summary.trees'),
# Uto Aztecan
read.nexus('~/Google Drive/UniWork/varikin/language-trees/uto-aztecan/utoaztecan-covarion-relaxed.mcct.trees')
)
con_trees = lapply(con_trees, ladderize)
files = list.files('data/co-evo/', pattern = '*.btdata', full.names = TRUE)
uto_link = read.csv('data/uto_link.csv')
files
f = files[4]
f
d = read.table(f)
rownames(d) = d[,1]
d
title = f %>%
basename(.) %>%
tools::file_path_sans_ext(.)
if(str_detect(f, "austronesian")){
td = geiger::treedata(con_trees[[1]], d)
mirrored_phylogeny(td$data, td$phy, title = title)
}
